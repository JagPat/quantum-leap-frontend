{
  "metadata": {
    "timestamp": "2025-09-18T12:30:59.476Z",
    "executionTime": 37703,
    "version": "1.0.0",
    "generator": "OAuth Deployment Verification System"
  },
  "summary": {
    "overallScore": 87,
    "totalTests": 84,
    "totalPassed": 73,
    "totalFailed": 24,
    "successRate": 87,
    "issueCount": {
      "critical": 0,
      "high": 4,
      "medium": 9,
      "low": 0
    }
  },
  "verificationResults": {
    "Database Schema Verification": false,
    "OAuth Endpoint Verification": {
      "success": false,
      "results": {
        "deployment": {
          "healthy": true,
          "info": {
            "appVersion": "2.0.0",
            "uptime": 1230164.736280369,
            "timestamp": "2025-09-18T12:30:45.011Z",
            "authModuleLoaded": true,
            "deploymentTimestamp": "2025-09-18T12:30:45.066Z"
          },
          "checksPasssed": 3,
          "totalChecks": 3
        },
        "fixes": {
          "passed": 3,
          "total": 3,
          "allFixed": true
        },
        "userIdHandling": {
          "passed": 1,
          "total": 3,
          "allPassed": false
        },
        "endpoints": {
          "passed": 6,
          "total": 9,
          "allPassed": false
        }
      },
      "metrics": {
        "totalTests": 18,
        "passedTests": 12,
        "failedTests": 6,
        "testResults": [
          {
            "name": "Application Health Check",
            "path": "/health",
            "method": "GET",
            "expectedStatus": 200,
            "actualStatus": 200,
            "responseTime": 60.487208000000464,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Application is ready"
            },
            "timestamp": "2025-09-18T12:30:28.362Z"
          },
          {
            "name": "Auth Module Debug Endpoint",
            "path": "/api/modules/auth/debug",
            "method": "GET",
            "expectedStatus": 200,
            "actualStatus": 200,
            "responseTime": 69.08420800000022,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Auth module debug endpoint accessible"
            },
            "timestamp": "2025-09-18T12:30:28.432Z"
          },
          {
            "name": "OAuth Health Check",
            "path": "/api/modules/auth/broker/health",
            "method": "GET",
            "expectedStatus": 200,
            "actualStatus": 200,
            "responseTime": 537.4329170000001,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "OAuth health check passed"
            },
            "timestamp": "2025-09-18T12:30:28.970Z"
          },
          {
            "name": "Valid OAuth Setup Request (Complete)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 200,
            "actualStatus": 500,
            "responseTime": 177.8430840000001,
            "success": false,
            "validationResult": null,
            "timestamp": "2025-09-18T12:30:29.148Z"
          },
          {
            "name": "OAuth Setup Without user_id (Auto-generation Test)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 200,
            "actualStatus": 400,
            "responseTime": 60.688625000000684,
            "success": false,
            "validationResult": null,
            "timestamp": "2025-09-18T12:30:29.209Z"
          },
          {
            "name": "Invalid OAuth Setup (Missing api_key)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 400,
            "actualStatus": 400,
            "responseTime": 61.97137500000008,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Proper validation error for missing api_key"
            },
            "timestamp": "2025-09-18T12:30:29.271Z"
          },
          {
            "name": "Invalid OAuth Setup (Missing api_secret)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 400,
            "actualStatus": 400,
            "responseTime": 60.785249999999905,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Proper validation error for missing api_secret"
            },
            "timestamp": "2025-09-18T12:30:29.332Z"
          },
          {
            "name": "Invalid OAuth Setup (Empty Payload)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 400,
            "actualStatus": 400,
            "responseTime": 60.54083300000002,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Proper error handling for empty payload"
            },
            "timestamp": "2025-09-18T12:30:29.393Z"
          },
          {
            "name": "OAuth Status Check",
            "path": "/api/modules/auth/broker/status?user_id=comprehensive_test_user",
            "method": "GET",
            "expectedStatus": 200,
            "actualStatus": 500,
            "responseTime": 168.34266599999955,
            "success": false,
            "validationResult": null,
            "timestamp": "2025-09-18T12:30:29.562Z"
          },
          {
            "name": "Application Health Check",
            "path": "/health",
            "method": "GET",
            "expectedStatus": 200,
            "actualStatus": 200,
            "responseTime": 64.0892500000009,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Application is ready"
            },
            "timestamp": "2025-09-18T12:30:46.101Z"
          },
          {
            "name": "Auth Module Debug Endpoint",
            "path": "/api/modules/auth/debug",
            "method": "GET",
            "expectedStatus": 200,
            "actualStatus": 200,
            "responseTime": 63.43141699999978,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Auth module debug endpoint accessible"
            },
            "timestamp": "2025-09-18T12:30:46.165Z"
          },
          {
            "name": "OAuth Health Check",
            "path": "/api/modules/auth/broker/health",
            "method": "GET",
            "expectedStatus": 200,
            "actualStatus": 200,
            "responseTime": 528.9889159999984,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "OAuth health check passed"
            },
            "timestamp": "2025-09-18T12:30:46.694Z"
          },
          {
            "name": "Valid OAuth Setup Request (Complete)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 200,
            "actualStatus": 500,
            "responseTime": 164.31816600000093,
            "success": false,
            "validationResult": null,
            "timestamp": "2025-09-18T12:30:46.859Z"
          },
          {
            "name": "OAuth Setup Without user_id (Auto-generation Test)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 200,
            "actualStatus": 400,
            "responseTime": 62.89629200000127,
            "success": false,
            "validationResult": null,
            "timestamp": "2025-09-18T12:30:46.922Z"
          },
          {
            "name": "Invalid OAuth Setup (Missing api_key)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 400,
            "actualStatus": 400,
            "responseTime": 63.57325000000128,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Proper validation error for missing api_key"
            },
            "timestamp": "2025-09-18T12:30:46.986Z"
          },
          {
            "name": "Invalid OAuth Setup (Missing api_secret)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 400,
            "actualStatus": 400,
            "responseTime": 63.34575000000041,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Proper validation error for missing api_secret"
            },
            "timestamp": "2025-09-18T12:30:47.049Z"
          },
          {
            "name": "Invalid OAuth Setup (Empty Payload)",
            "path": "/api/modules/auth/broker/setup-oauth",
            "method": "POST",
            "expectedStatus": 400,
            "actualStatus": 400,
            "responseTime": 63.33054099999936,
            "success": true,
            "validationResult": {
              "valid": true,
              "message": "Proper error handling for empty payload"
            },
            "timestamp": "2025-09-18T12:30:47.113Z"
          },
          {
            "name": "OAuth Status Check",
            "path": "/api/modules/auth/broker/status?user_id=comprehensive_test_user",
            "method": "GET",
            "expectedStatus": 200,
            "actualStatus": 500,
            "responseTime": 168.57941700000083,
            "success": false,
            "validationResult": null,
            "timestamp": "2025-09-18T12:30:47.282Z"
          }
        ],
        "startTime": 19.976041,
        "deploymentInfo": {
          "appVersion": "2.0.0",
          "uptime": 1230164.736280369,
          "timestamp": "2025-09-18T12:30:45.011Z",
          "authModuleLoaded": true,
          "deploymentTimestamp": "2025-09-18T12:30:45.066Z"
        }
      }
    },
    "Production Health Monitoring": {
      "healthy": true,
      "results": {
        "setupOAuth": {
          "endpoint": "/api/modules/auth/broker/setup-oauth",
          "passed": 3,
          "total": 3,
          "healthy": true,
          "results": [
            {
              "name": "Endpoint Availability (404 Check)",
              "success": true,
              "details": {
                "status": 400,
                "available": true,
                "responseTime": 63.13408400000117,
                "timestamp": "2025-09-18T12:30:47.345Z"
              },
              "responseTime": 63.13408400000117
            },
            {
              "name": "Valid Request Processing",
              "success": "Database connection not initialized",
              "details": {
                "status": 500,
                "validProcessing": "Database connection not initialized",
                "response": {
                  "success": false,
                  "error": "Failed to setup OAuth",
                  "message": "Database connection not initialized"
                },
                "responseTime": 171.73725000000195,
                "timestamp": "2025-09-18T12:30:47.517Z"
              },
              "responseTime": 171.73725000000195
            },
            {
              "name": "Invalid Request Data Detection",
              "success": true,
              "details": {
                "status": 400,
                "properErrorHandling": true,
                "errorMessage": "Invalid request data",
                "responseTime": 63.15929200000028,
                "timestamp": "2025-09-18T12:30:47.580Z"
              },
              "responseTime": 63.15929200000028
            }
          ]
        },
        "brokerHealth": {
          "endpoint": "/api/modules/auth/broker/health",
          "passed": 3,
          "total": 3,
          "healthy": true,
          "results": [
            {
              "name": "Endpoint Availability",
              "success": true,
              "details": {
                "status": 200,
                "available": true,
                "responseTime": 556.2483750000029,
                "timestamp": "2025-09-18T12:30:48.137Z"
              },
              "responseTime": 556.2483750000029
            },
            {
              "name": "Successful Health Status",
              "success": true,
              "details": {
                "status": 200,
                "successField": true,
                "healthData": {
                  "status": "healthy",
                  "brokerService": "operational",
                  "components": {
                    "brokerConfigs": {
                      "status": "error",
                      "error": "Database connection not initialized",
                      "timestamp": "2025-09-18T12:30:48.597Z"
                    },
                    "tokenManager": {
                      "status": "healthy",
                      "tokenManager": "operational",
                      "components": {
                        "oauthTokens": {
                          "status": "error",
                          "error": "Database connection not initialized",
                          "timestamp": "2025-09-18T12:30:48.597Z"
                        },
                        "brokerConfigs": {
                          "status": "error",
                          "error": "Database connection not initialized",
                          "timestamp": "2025-09-18T12:30:48.597Z"
                        },
                        "kiteClient": {
                          "status": "healthy",
                          "kiteApiReachable": true,
                          "statusCode": 429,
                          "timestamp": "2025-09-18T12:30:48.635Z"
                        }
                      },
                      "refreshJob": "running",
                      "timestamp": "2025-09-18T12:30:48.635Z"
                    },
                    "kiteClient": {
                      "status": "healthy",
                      "kiteApiReachable": true,
                      "statusCode": 429,
                      "timestamp": "2025-09-18T12:30:48.681Z"
                    }
                  },
                  "monitoring": "active",
                  "timestamp": "2025-09-18T12:30:48.681Z"
                },
                "responseTime": 536.2151249999988,
                "timestamp": "2025-09-18T12:30:48.673Z"
              },
              "responseTime": 536.2151249999988
            },
            {
              "name": "Response Format Validation",
              "success": true,
              "details": {
                "status": 200,
                "validFormat": true,
                "hasSuccessField": true,
                "hasDataField": true,
                "responseTime": 538.2512079999979,
                "timestamp": "2025-09-18T12:30:49.212Z"
              },
              "responseTime": 538.2512079999979
            }
          ]
        },
        "statusFormats": {
          "passed": 4,
          "total": 4,
          "healthy": true,
          "results": [
            {
              "name": "Application Health Status",
              "success": true,
              "details": {
                "endpoint": "/health",
                "expectedStatus": 200,
                "actualStatus": 200,
                "statusCorrect": true,
                "formatValid": true,
                "responseTime": 62.56733299999905,
                "timestamp": "2025-09-18T12:30:49.275Z"
              },
              "responseTime": 62.56733299999905
            },
            {
              "name": "Auth Module Debug Status",
              "success": true,
              "details": {
                "endpoint": "/api/modules/auth/debug",
                "expectedStatus": 200,
                "actualStatus": 200,
                "statusCorrect": true,
                "formatValid": true,
                "responseTime": 62.65033299999777,
                "timestamp": "2025-09-18T12:30:49.338Z"
              },
              "responseTime": 62.65033299999777
            },
            {
              "name": "OAuth Health Status",
              "success": true,
              "details": {
                "endpoint": "/api/modules/auth/broker/health",
                "expectedStatus": 200,
                "actualStatus": 200,
                "statusCorrect": true,
                "formatValid": true,
                "responseTime": 514.7223750000012,
                "timestamp": "2025-09-18T12:30:49.853Z"
              },
              "responseTime": 514.7223750000012
            },
            {
              "name": "OAuth Setup Bad Request Status",
              "success": true,
              "details": {
                "endpoint": "/api/modules/auth/broker/setup-oauth",
                "expectedStatus": 400,
                "actualStatus": 400,
                "statusCorrect": true,
                "formatValid": true,
                "responseTime": 63.07849999999962,
                "timestamp": "2025-09-18T12:30:49.916Z"
              },
              "responseTime": 63.07849999999962
            }
          ]
        },
        "errorAnalysis": {
          "passed": 3,
          "total": 3,
          "healthy": true,
          "results": [
            {
              "name": "Invalid Request Data Error Detection",
              "success": true,
              "details": {
                "hasInvalidRequestDataError": true,
                "status": 400,
                "errorMessage": "Invalid request data",
                "responseTime": 62.9340830000001
              }
            },
            {
              "name": "Missing Required Fields Error",
              "success": true,
              "details": {
                "hasProperValidationError": true,
                "status": 400,
                "errorMessage": "Invalid request data",
                "details": "\"api_key\" is required",
                "responseTime": 69.4698329999992
              }
            },
            {
              "name": "Database Connection Error Handling",
              "success": true,
              "details": {
                "hasProperDbErrorHandling": "Database connection not initialized",
                "status": 500,
                "errorMessage": "Failed to setup OAuth",
                "responseTime": 163.49166600000171
              }
            }
          ]
        }
      },
      "metrics": {
        "totalChecks": 13,
        "successfulChecks": 13,
        "failedChecks": 0,
        "endpointStatus": {
          "setupOAuth": true,
          "brokerHealth": true,
          "statusFormats": true,
          "errorHandling": true
        },
        "responseTimeHistory": [
          194.5859743076924,
          202.44337500000003
        ],
        "errorHistory": [],
        "startTime": 21.213041,
        "lastCheckTime": "2025-09-18T12:30:47.282Z"
      },
      "summary": {
        "totalTests": 13,
        "totalPassed": 13,
        "healthScore": 100,
        "avgResponseTime": 202,
        "executionTime": 28442
      }
    },
    "End-to-End OAuth Verification": {
      "success": false,
      "results": {
        "frontend": {
          "phase": "Frontend Loading",
          "passed": 0,
          "total": 2,
          "healthy": false,
          "results": [
            {
              "name": "Frontend Accessibility",
              "success": false,
              "details": {
                "status": 404,
                "accessible": false,
                "contentType": "application/json",
                "responseTime": 496.2741669999996,
                "timestamp": "2025-09-18T12:30:50.710Z"
              },
              "responseTime": 496.2741669999996
            },
            {
              "name": "Broker Setup Interface Detection",
              "success": false,
              "details": {
                "status": 404,
                "hasSetupInterface": false,
                "contentLength": 0,
                "responseTime": 60.95958299999984,
                "timestamp": "2025-09-18T12:30:50.771Z"
              },
              "responseTime": 60.95958299999984
            }
          ]
        },
        "oauth": {
          "phase": "OAuth URL Generation",
          "passed": 0,
          "total": 2,
          "healthy": false,
          "results": [
            {
              "name": "Valid OAuth URL Generation",
              "success": false,
              "details": {
                "status": 500,
                "hasOAuthURL": false,
                "responseTime": 158.91354100000171,
                "timestamp": "2025-09-18T12:30:50.931Z"
              },
              "responseTime": 158.91354100000171
            },
            {
              "name": "OAuth URL Structure Validation",
              "success": false,
              "details": {
                "error": "No OAuth URL available from previous test",
                "responseTime": 0
              },
              "responseTime": 0
            }
          ]
        },
        "state": {
          "phase": "CSRF State Storage",
          "passed": 0,
          "total": 2,
          "healthy": false,
          "results": [
            {
              "name": "OAuth State Generation and Storage",
              "success": false,
              "details": {
                "error": "No OAuth state or user ID available from previous test",
                "responseTime": 0
              },
              "responseTime": 0
            },
            {
              "name": "State Parameter Validation",
              "success": false,
              "details": {
                "error": "No OAuth state available from previous test",
                "responseTime": 0
              },
              "responseTime": 0
            }
          ]
        },
        "callback": {
          "phase": "OAuth Callback Handling",
          "passed": 0,
          "total": 2,
          "healthy": false,
          "results": [
            {
              "name": "Callback Endpoint Availability",
              "success": false,
              "details": {
                "status": 404,
                "available": false,
                "response": {
                  "error": "Route not found",
                  "path": "/api/modules/auth/broker/callback?request_token=test&state=test",
                  "server": "modular",
                  "port": "8080"
                },
                "responseTime": 64.70237500000076,
                "timestamp": "2025-09-18T12:30:50.997Z"
              },
              "responseTime": 64.70237500000076
            },
            {
              "name": "Connection Status Update Capability",
              "success": false,
              "details": {
                "error": "No user ID available from previous test",
                "responseTime": 0
              },
              "responseTime": 0
            }
          ]
        }
      },
      "metrics": {
        "totalTests": 8,
        "passedTests": 0,
        "failedTests": 8,
        "testResults": [
          {
            "phase": "Frontend Loading",
            "name": "Frontend Accessibility",
            "success": false,
            "details": {
              "status": 404,
              "accessible": false,
              "contentType": "application/json",
              "responseTime": 496.2741669999996,
              "timestamp": "2025-09-18T12:30:50.710Z"
            },
            "responseTime": 496.2741669999996
          },
          {
            "phase": "Frontend Loading",
            "name": "Broker Setup Interface Detection",
            "success": false,
            "details": {
              "status": 404,
              "hasSetupInterface": false,
              "contentLength": 0,
              "responseTime": 60.95958299999984,
              "timestamp": "2025-09-18T12:30:50.771Z"
            },
            "responseTime": 60.95958299999984
          },
          {
            "phase": "OAuth URL Generation",
            "name": "Valid OAuth URL Generation",
            "success": false,
            "details": {
              "status": 500,
              "hasOAuthURL": false,
              "responseTime": 158.91354100000171,
              "timestamp": "2025-09-18T12:30:50.931Z"
            },
            "responseTime": 158.91354100000171
          },
          {
            "phase": "OAuth URL Generation",
            "name": "OAuth URL Structure Validation",
            "success": false,
            "details": {
              "error": "No OAuth URL available from previous test",
              "responseTime": 0
            },
            "responseTime": 0
          },
          {
            "phase": "CSRF State Storage",
            "name": "OAuth State Generation and Storage",
            "success": false,
            "details": {
              "error": "No OAuth state or user ID available from previous test",
              "responseTime": 0
            },
            "responseTime": 0
          },
          {
            "phase": "CSRF State Storage",
            "name": "State Parameter Validation",
            "success": false,
            "details": {
              "error": "No OAuth state available from previous test",
              "responseTime": 0
            },
            "responseTime": 0
          },
          {
            "phase": "OAuth Callback Handling",
            "name": "Callback Endpoint Availability",
            "success": false,
            "details": {
              "status": 404,
              "available": false,
              "response": {
                "error": "Route not found",
                "path": "/api/modules/auth/broker/callback?request_token=test&state=test",
                "server": "modular",
                "port": "8080"
              },
              "responseTime": 64.70237500000076,
              "timestamp": "2025-09-18T12:30:50.997Z"
            },
            "responseTime": 64.70237500000076
          },
          {
            "phase": "OAuth Callback Handling",
            "name": "Connection Status Update Capability",
            "success": false,
            "details": {
              "error": "No user ID available from previous test",
              "responseTime": 0
            },
            "responseTime": 0
          }
        ],
        "startTime": 21.733458,
        "oauthFlowData": null
      },
      "summary": {
        "totalTests": 8,
        "totalPassed": 0,
        "successRate": 0,
        "avgResponseTime": 98,
        "executionTime": 29226,
        "phasesPasssed": 0,
        "totalPhases": 4
      }
    },
    "Error Handling Verification": {
      "success": false,
      "results": {
        "credentials": {
          "phase": "Invalid Credential Handling",
          "passed": 3,
          "total": 4,
          "healthy": false,
          "results": [
            {
              "name": "Missing API Key Validation",
              "success": true,
              "details": {
                "status": 400,
                "hasValidationError": true,
                "hasApiKeyError": true,
                "isClearMessage": true,
                "errorMessage": "Invalid request data",
                "errorDetails": "\"api_key\" is required",
                "responseTime": 68.69441599999845
              },
              "responseTime": 68.69441599999845
            },
            {
              "name": "Missing API Secret Validation",
              "success": false,
              "details": {
                "status": 400,
                "hasValidationError": true,
                "hasApiSecretError": false,
                "isClearMessage": true,
                "errorMessage": "Invalid request data",
                "errorDetails": "\"api_key\" length must be at least 10 characters long",
                "responseTime": 64.656041000002
              },
              "responseTime": 64.656041000002
            },
            {
              "name": "Invalid Data Format Validation",
              "success": true,
              "details": {
                "status": 400,
                "hasValidationError": true,
                "hasProperValidation": true,
                "isClearMessage": true,
                "errorMessage": "Invalid request data",
                "errorDetails": "\"api_key\" is not allowed to be empty",
                "responseTime": 64.44854100000157
              },
              "responseTime": 64.44854100000157
            },
            {
              "name": "Malformed JSON Handling",
              "success": "Internal server error",
              "details": {
                "status": 500,
                "hasErrorHandling": true,
                "hasProperErrorMessage": "Internal server error",
                "errorMessage": "Internal server error",
                "responseTime": 100
              },
              "responseTime": 100
            }
          ]
        },
        "database": {
          "phase": "Database Connection Failure Handling",
          "passed": 3,
          "total": 3,
          "healthy": true,
          "results": [
            {
              "name": "Database Connection Error Response",
              "success": true,
              "details": {
                "status": 500,
                "hasProperErrorHandling": true,
                "hasUserFriendlyMessage": true,
                "doesNotExposeSensitiveInfo": true,
                "errorMessage": "Failed to setup OAuth",
                "message": "Database connection not initialized",
                "responseTime": 167.9549999999981
              },
              "responseTime": 167.9549999999981
            },
            {
              "name": "Database Health Check Error Handling",
              "success": true,
              "details": {
                "status": 200,
                "hasHealthResponse": true,
                "hasDbStatusInfo": true,
                "handlesDbErrors": true,
                "dbErrorsDetected": true,
                "responseTime": 570.3758330000019
              },
              "responseTime": 570.3758330000019
            },
            {
              "name": "Status Check Database Error Handling",
              "success": true,
              "details": {
                "status": 500,
                "hasErrorResponse": true,
                "hasProperErrorMessage": true,
                "doesNotExposeSensitiveInfo": true,
                "errorMessage": "Failed to check status",
                "responseTime": 171.94533299999966
              },
              "responseTime": 171.94533299999966
            }
          ]
        },
        "oauth": {
          "phase": "OAuth Authorization Failure Handling",
          "passed": 2,
          "total": 3,
          "healthy": false,
          "results": [
            {
              "name": "Invalid OAuth Credentials Handling",
              "success": true,
              "details": {
                "status": 500,
                "hasProperErrorHandling": true,
                "hasUserFriendlyMessage": "Failed to setup OAuth",
                "doesNotExposeSecrets": true,
                "errorMessage": "Failed to setup OAuth",
                "message": "Database connection not initialized",
                "responseTime": 162.16558400000213
              },
              "responseTime": 162.16558400000213
            },
            {
              "name": "OAuth State Validation Error Handling",
              "success": true,
              "details": {
                "status": 404,
                "hasErrorResponse": true,
                "hasProperErrorMessage": true,
                "errorMessage": "Route not found",
                "responseTime": 63.24062500000218
              },
              "responseTime": 63.24062500000218
            },
            {
              "name": "OAuth Flow Interruption Handling",
              "success": false,
              "details": {
                "status": 500,
                "hasProperResponse": false,
                "hasUserFriendlyMessage": "Failed to check status",
                "doesNotExposeInternalDetails": true,
                "errorMessage": "Failed to check status",
                "responseTime": 164.63633299999856
              },
              "responseTime": 164.63633299999856
            }
          ]
        },
        "network": {
          "phase": "Network Issue and Timeout Handling",
          "passed": 4,
          "total": 4,
          "healthy": true,
          "results": [
            {
              "name": "Request Timeout Handling",
              "success": true,
              "details": {
                "isTimeoutError": true,
                "errorCode": "TIMEOUT",
                "errorMessage": "Request timeout",
                "responseTime": 101.47399999999834,
                "message": "Timeout properly handled"
              },
              "responseTime": 101.47399999999834
            },
            {
              "name": "Large Payload Handling",
              "success": "Invalid request data",
              "details": {
                "status": 400,
                "hasProperHandling": true,
                "hasErrorMessage": "Invalid request data",
                "errorMessage": "Invalid request data",
                "payloadSize": 10087,
                "responseTime": 343.3374160000021
              },
              "responseTime": 343.3374160000021
            },
            {
              "name": "Concurrent Request Handling",
              "success": true,
              "details": {
                "allSuccessful": true,
                "concurrentRequests": 5,
                "avgResponseTime": 1974,
                "maxResponseTime": 2017,
                "responseTimes": [
                  1944,
                  2017,
                  1972,
                  1993,
                  1944
                ],
                "message": "Concurrent requests handled successfully"
              },
              "responseTime": 1974.0327999999995
            },
            {
              "name": "Retry Mechanism Verification",
              "success": true,
              "details": {
                "bothResponded": 500,
                "reasonableTime": true,
                "consistentBehavior": true,
                "totalTime": 332,
                "response1Status": 500,
                "response2Status": 500,
                "message": "Retry mechanism working"
              },
              "responseTime": 165.95352099999945
            }
          ]
        }
      },
      "metrics": {
        "totalTests": 28,
        "passedTests": 24,
        "failedTests": 4,
        "testResults": [],
        "startTime": 23.0415,
        "errorPatterns": {
          "validationErrors": [
            {
              "test": "Missing API Key Validation",
              "errorMessage": "Invalid request data",
              "status": 400
            },
            {
              "test": "Invalid Data Format Validation",
              "errorMessage": "Invalid request data",
              "status": 400
            },
            {
              "test": "Malformed JSON Handling",
              "errorMessage": "Internal server error",
              "status": 500
            },
            {
              "test": "Missing API Key Validation",
              "errorMessage": "Invalid request data",
              "status": 400
            },
            {
              "test": "Invalid Data Format Validation",
              "errorMessage": "Invalid request data",
              "status": 400
            },
            {
              "test": "Malformed JSON Handling",
              "errorMessage": "Internal server error",
              "status": 500
            }
          ],
          "databaseErrors": [
            {
              "test": "Database Connection Error Response",
              "errorMessage": "Failed to setup OAuth",
              "status": 500
            },
            {
              "test": "Database Health Check Error Handling",
              "status": 200
            },
            {
              "test": "Status Check Database Error Handling",
              "errorMessage": "Failed to check status",
              "status": 500
            },
            {
              "test": "Database Connection Error Response",
              "errorMessage": "Failed to setup OAuth",
              "status": 500
            },
            {
              "test": "Database Health Check Error Handling",
              "status": 200
            },
            {
              "test": "Status Check Database Error Handling",
              "errorMessage": "Failed to check status",
              "status": 500
            }
          ],
          "oauthErrors": [
            {
              "test": "Invalid OAuth Credentials Handling",
              "errorMessage": "Failed to setup OAuth",
              "status": 500
            },
            {
              "test": "OAuth State Validation Error Handling",
              "errorMessage": "Route not found",
              "status": 404
            },
            {
              "test": "Invalid OAuth Credentials Handling",
              "errorMessage": "Failed to setup OAuth",
              "status": 500
            },
            {
              "test": "OAuth State Validation Error Handling",
              "errorMessage": "Route not found",
              "status": 404
            }
          ],
          "networkErrors": [
            {
              "test": "Request Timeout Handling",
              "message": "Timeout properly handled",
              "responseTime": 101.59983300000022
            },
            {
              "test": "Large Payload Handling",
              "responseTime": 349.1423329999998
            },
            {
              "test": "Concurrent Request Handling",
              "message": "Concurrent requests handled successfully",
              "responseTime": 1830.5548832000004
            },
            {
              "test": "Retry Mechanism Verification",
              "message": "Retry mechanism working",
              "responseTime": 157.31258350000007
            },
            {
              "test": "Request Timeout Handling",
              "message": "Timeout properly handled",
              "responseTime": 101.47399999999834
            },
            {
              "test": "Large Payload Handling",
              "responseTime": 343.3374160000021
            },
            {
              "test": "Concurrent Request Handling",
              "message": "Concurrent requests handled successfully",
              "responseTime": 1974.0327999999995
            },
            {
              "test": "Retry Mechanism Verification",
              "message": "Retry mechanism working",
              "responseTime": 165.95352099999945
            }
          ]
        }
      },
      "summary": {
        "totalTests": 28,
        "totalPassed": 24,
        "successRate": 86,
        "avgResponseTime": 0,
        "executionTime": 33585,
        "phasesPasssed": 2,
        "totalPhases": 4
      }
    },
    "Security Verification": {
      "secure": false,
      "results": {
        "encryption": {
          "phase": "Credential Encryption Verification",
          "passed": 4,
          "total": 4,
          "healthy": true,
          "results": [
            {
              "name": "Sensitive Data Not Exposed in Responses",
              "success": true,
              "details": {
                "status": 500,
                "exposesApiKey": false,
                "exposesApiSecret": false,
                "exposesCredentials": false,
                "responseContainsCredentials": "NO - SECURE",
                "responseTime": 170.00645900000382
              },
              "responseTime": 170.00645900000382
            },
            {
              "name": "Error Messages Do Not Expose Credentials",
              "success": true,
              "details": {
                "status": 500,
                "exposesApiKey": false,
                "exposesApiSecret": false,
                "exposesCredentials": false,
                "errorResponseSecure": true,
                "responseTime": 161.94666599999618
              },
              "responseTime": 161.94666599999618
            },
            {
              "name": "Database Connection Strings Not Exposed",
              "success": true,
              "details": {
                "status": 200,
                "exposesDbUrl": false,
                "exposesDbPassword": false,
                "exposesDbCredentials": false,
                "healthResponseSecure": true,
                "responseTime": 529.6711660000001
              },
              "responseTime": 529.6711660000001
            },
            {
              "name": "Internal System Details Not Exposed",
              "success": true,
              "details": {
                "status": 200,
                "exposesFilePaths": false,
                "exposesEnvVars": false,
                "exposesInternalDetails": false,
                "debugResponseSecure": true,
                "responseTime": 62.63325000000623
              },
              "responseTime": 62.63325000000623
            }
          ]
        },
        "tokenSecurity": {
          "phase": "OAuth Token Security Validation",
          "passed": 2,
          "total": 4,
          "healthy": false,
          "results": [
            {
              "name": "OAuth State Parameter Generation",
              "details": {
                "status": 500,
                "stateLength": 0,
                "isSecureLength": false,
                "stateValue": "none",
                "responseTime": 182.66300000000047
              },
              "responseTime": 182.66300000000047
            },
            {
              "name": "OAuth URL Security Parameters",
              "details": {
                "status": 500,
                "hasState": false,
                "hasResponseType": false,
                "hasRedirectUri": false,
                "isHttps": false,
                "responseTime": 166.32795800000167
              },
              "responseTime": 166.32795800000167
            },
            {
              "name": "Token Storage Security",
              "success": true,
              "details": {
                "status": 500,
                "exposesAccessToken": false,
                "exposesRefreshToken": false,
                "exposesTokens": false,
                "tokenStorageSecure": true,
                "responseTime": 167.08699999999953
              },
              "responseTime": 167.08699999999953
            },
            {
              "name": "Secure Transmission Verification",
              "success": true,
              "details": {
                "allHttps": true,
                "hasSecurityHeaders": true,
                "endpointChecks": [
                  {
                    "endpoint": "/api/modules/auth/broker/setup-oauth",
                    "isHttps": true,
                    "hasSecureHeaders": true,
                    "status": 404
                  },
                  {
                    "endpoint": "/api/modules/auth/broker/health",
                    "isHttps": true,
                    "hasSecureHeaders": true,
                    "status": 200
                  },
                  {
                    "endpoint": "/api/modules/auth/broker/status",
                    "isHttps": true,
                    "hasSecureHeaders": true,
                    "status": 400
                  }
                ],
                "secureTransmission": true,
                "responseTime": 0
              },
              "responseTime": 0
            }
          ]
        },
        "csrf": {
          "phase": "CSRF Protection Verification",
          "passed": 2,
          "total": 3,
          "healthy": false,
          "results": [
            {
              "name": "OAuth State Parameter Validation",
              "success": "Route not found",
              "details": {
                "status": 404,
                "rejectsInvalidState": true,
                "hasErrorMessage": "Route not found",
                "properCSRFProtection": "Route not found",
                "errorMessage": "Route not found",
                "responseTime": 62.96295799999643
              },
              "responseTime": 62.96295799999643
            },
            {
              "name": "State Parameter Uniqueness",
              "success": false,
              "details": {
                "statesGenerated": 0,
                "uniqueStates": 0,
                "allUnique": false,
                "stateUniqueness": "INSECURE",
                "responseTime": 0
              },
              "responseTime": 0
            },
            {
              "name": "Cross-Site Request Forgery Prevention",
              "success": "Failed to setup OAuth",
              "details": {
                "status": 500,
                "hasCSRFProtection": "Failed to setup OAuth",
                "csrfProtectionLevel": "PROTECTED",
                "responseTime": 100
              },
              "responseTime": 100
            }
          ]
        },
        "https": {
          "phase": "HTTPS and Security Headers Verification",
          "passed": 4,
          "total": 4,
          "healthy": true,
          "results": [
            {
              "name": "HTTPS Enforcement",
              "success": true,
              "details": {
                "baseUrlHttps": true,
                "healthEndpointAccessible": true,
                "httpsEnforced": true,
                "responseTime": 62.819917000000714
              },
              "responseTime": 62.819917000000714
            },
            {
              "name": "Security Headers Verification",
              "success": true,
              "details": {
                "status": 200,
                "hasStrictTransportSecurity": true,
                "hasXFrameOptions": true,
                "hasXContentTypeOptions": true,
                "hasXXSSProtection": true,
                "hasContentSecurityPolicy": true,
                "hasReferrerPolicy": true,
                "securityHeaderCount": 6,
                "hasBasicSecurity": true,
                "allHeaders": [
                  "access-control-allow-credentials",
                  "content-length",
                  "content-security-policy",
                  "content-type",
                  "cross-origin-opener-policy",
                  "cross-origin-resource-policy",
                  "date",
                  "etag",
                  "origin-agent-cluster",
                  "referrer-policy",
                  "server",
                  "strict-transport-security",
                  "vary",
                  "x-content-type-options",
                  "x-dns-prefetch-control",
                  "x-download-options",
                  "x-frame-options",
                  "x-permitted-cross-domain-policies",
                  "x-railway-edge",
                  "x-railway-request-id",
                  "x-request-id",
                  "x-xss-protection"
                ],
                "responseTime": 536.445375000003
              },
              "responseTime": 536.445375000003
            },
            {
              "name": "Content Type Security",
              "success": true,
              "details": {
                "status": 200,
                "contentType": "application/json; charset=utf-8",
                "isJsonContentType": true,
                "hasCharset": true,
                "properContentType": true,
                "responseTime": 578.9148339999956
              },
              "responseTime": 578.9148339999956
            },
            {
              "name": "TLS/SSL Configuration",
              "success": true,
              "details": {
                "httpsWorking": true,
                "tlsSecure": true,
                "baseUrl": "https://web-production-de0bc.up.railway.app",
                "connectionSecure": true,
                "responseTime": 62.49479200000496
              },
              "responseTime": 62.49479200000496
            }
          ]
        }
      },
      "metrics": {
        "totalTests": 30,
        "passedTests": 24,
        "failedTests": 6,
        "testResults": [],
        "startTime": 23.948583,
        "securityFindings": {
          "encryptionIssues": [],
          "tokenSecurityIssues": [
            {
              "test": "OAuth State Parameter Generation",
              "issue": {
                "status": 500,
                "stateLength": 0,
                "isSecureLength": false,
                "stateValue": "none",
                "responseTime": 153.22029199999997
              },
              "severity": "HIGH"
            },
            {
              "test": "OAuth URL Security Parameters",
              "issue": {
                "status": 500,
                "hasState": false,
                "hasResponseType": false,
                "hasRedirectUri": false,
                "isHttps": false,
                "responseTime": 167.5206249999992
              },
              "severity": "HIGH"
            },
            {
              "test": "OAuth State Parameter Generation",
              "issue": {
                "status": 500,
                "stateLength": 0,
                "isSecureLength": false,
                "stateValue": "none",
                "responseTime": 182.66300000000047
              },
              "severity": "HIGH"
            },
            {
              "test": "OAuth URL Security Parameters",
              "issue": {
                "status": 500,
                "hasState": false,
                "hasResponseType": false,
                "hasRedirectUri": false,
                "isHttps": false,
                "responseTime": 166.32795800000167
              },
              "severity": "HIGH"
            }
          ],
          "csrfIssues": [
            {
              "test": "State Parameter Uniqueness",
              "issue": {
                "statesGenerated": 0,
                "uniqueStates": 0,
                "allUnique": false,
                "stateUniqueness": "INSECURE",
                "responseTime": 0
              },
              "severity": "HIGH"
            },
            {
              "test": "State Parameter Uniqueness",
              "issue": {
                "statesGenerated": 0,
                "uniqueStates": 0,
                "allUnique": false,
                "stateUniqueness": "INSECURE",
                "responseTime": 0
              },
              "severity": "HIGH"
            }
          ],
          "httpsIssues": []
        }
      },
      "summary": {
        "totalTests": 30,
        "totalPassed": 24,
        "securityScore": 80,
        "avgResponseTime": 0,
        "executionTime": 37701,
        "securePhases": 2,
        "totalPhases": 4,
        "securityIssues": 6
      }
    }
  },
  "issues": {
    "critical": [],
    "high": [
      {
        "id": "end-to-end_oauth_verification_-_frontend_1758198650997_geqf2",
        "phase": "End-to-End OAuth Verification - frontend",
        "test": "Broker Setup Interface Detection",
        "status": "FAIL",
        "severity": "HIGH",
        "category": "OAUTH",
        "description": "OAuth URL generation or setup issues",
        "recommendation": "Fix database connection to enable OAuth URL generation",
        "impact": "Users cannot initiate broker connections",
        "effort": "HIGH",
        "timestamp": "2025-09-18T12:30:50.997Z"
      },
      {
        "id": "end-to-end_oauth_verification_-_oauth_1758198650997_zienz",
        "phase": "End-to-End OAuth Verification - oauth",
        "test": "Valid OAuth URL Generation",
        "status": "FAIL",
        "severity": "HIGH",
        "category": "OAUTH",
        "description": "OAuth URL generation or setup issues",
        "recommendation": "Fix database connection to enable OAuth URL generation",
        "impact": "Users cannot initiate broker connections",
        "effort": "HIGH",
        "timestamp": "2025-09-18T12:30:50.997Z"
      },
      {
        "id": "security_verification_-_tokensecurity_1758198659475_ik25d",
        "phase": "Security Verification - tokenSecurity",
        "test": "OAuth State Parameter Generation",
        "status": "FAIL",
        "severity": "HIGH",
        "category": "SECURITY",
        "description": "CSRF protection or state validation issues",
        "recommendation": "Implement proper OAuth state parameter validation",
        "impact": "Vulnerability to CSRF attacks",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:59.475Z"
      },
      {
        "id": "security_verification_-_csrf_1758198659475_aqaai",
        "phase": "Security Verification - csrf",
        "test": "State Parameter Uniqueness",
        "status": "FAIL",
        "severity": "HIGH",
        "category": "SECURITY",
        "description": "CSRF protection or state validation issues",
        "recommendation": "Implement proper OAuth state parameter validation",
        "impact": "Vulnerability to CSRF attacks",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:59.475Z"
      }
    ],
    "medium": [
      {
        "id": "end-to-end_oauth_verification_-_frontend_1758198650997_3gc5r",
        "phase": "End-to-End OAuth Verification - frontend",
        "test": "Frontend Accessibility",
        "status": "FAIL",
        "severity": "MEDIUM",
        "category": "OAUTH",
        "description": "",
        "recommendation": "",
        "impact": "",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:50.997Z"
      },
      {
        "id": "end-to-end_oauth_verification_-_oauth_1758198650997_u3hdt",
        "phase": "End-to-End OAuth Verification - oauth",
        "test": "OAuth URL Structure Validation",
        "status": "FAIL",
        "severity": "MEDIUM",
        "category": "OAUTH",
        "description": "OAuth validation or fix verification issues",
        "recommendation": "Review OAuth endpoint validation logic",
        "impact": "May cause user experience issues",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:50.997Z"
      },
      {
        "id": "end-to-end_oauth_verification_-_state_1758198650997_dii0z",
        "phase": "End-to-End OAuth Verification - state",
        "test": "OAuth State Generation and Storage",
        "status": "FAIL",
        "severity": "MEDIUM",
        "category": "OAUTH",
        "description": "",
        "recommendation": "",
        "impact": "",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:50.997Z"
      },
      {
        "id": "end-to-end_oauth_verification_-_state_1758198650997_xf3qo",
        "phase": "End-to-End OAuth Verification - state",
        "test": "State Parameter Validation",
        "status": "FAIL",
        "severity": "MEDIUM",
        "category": "OAUTH",
        "description": "OAuth validation or fix verification issues",
        "recommendation": "Review OAuth endpoint validation logic",
        "impact": "May cause user experience issues",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:50.997Z"
      },
      {
        "id": "end-to-end_oauth_verification_-_callback_1758198650997_stjng",
        "phase": "End-to-End OAuth Verification - callback",
        "test": "Callback Endpoint Availability",
        "status": "FAIL",
        "severity": "MEDIUM",
        "category": "OAUTH",
        "description": "",
        "recommendation": "",
        "impact": "",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:50.997Z"
      },
      {
        "id": "end-to-end_oauth_verification_-_callback_1758198650997_atyjw",
        "phase": "End-to-End OAuth Verification - callback",
        "test": "Connection Status Update Capability",
        "status": "FAIL",
        "severity": "MEDIUM",
        "category": "OAUTH",
        "description": "",
        "recommendation": "",
        "impact": "",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:50.997Z"
      },
      {
        "id": "error_handling_verification_-_credentials_1758198655358_lkido",
        "phase": "Error Handling Verification - credentials",
        "test": "Missing API Secret Validation",
        "status": "FAIL",
        "severity": "MEDIUM",
        "category": "ERROR_HANDLING",
        "description": "",
        "recommendation": "",
        "impact": "",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:55.358Z"
      },
      {
        "id": "error_handling_verification_-_oauth_1758198655358_beyj0",
        "phase": "Error Handling Verification - oauth",
        "test": "OAuth Flow Interruption Handling",
        "status": "FAIL",
        "severity": "MEDIUM",
        "category": "ERROR_HANDLING",
        "description": "",
        "recommendation": "",
        "impact": "",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:55.358Z"
      },
      {
        "id": "security_verification_-_tokensecurity_1758198659475_kgoka",
        "phase": "Security Verification - tokenSecurity",
        "test": "OAuth URL Security Parameters",
        "status": "FAIL",
        "severity": "MEDIUM",
        "category": "SECURITY",
        "description": "",
        "recommendation": "",
        "impact": "",
        "effort": "MEDIUM",
        "timestamp": "2025-09-18T12:30:59.475Z"
      }
    ],
    "low": []
  },
  "recommendations": {
    "immediate": [
      {
        "category": "OAUTH",
        "recommendation": "Fix database connection to enable OAuth URL generation",
        "impact": "Users cannot initiate broker connections",
        "effort": "HIGH"
      },
      {
        "category": "OAUTH",
        "recommendation": "Fix database connection to enable OAuth URL generation",
        "impact": "Users cannot initiate broker connections",
        "effort": "HIGH"
      },
      {
        "category": "SECURITY",
        "recommendation": "Implement proper OAuth state parameter validation",
        "impact": "Vulnerability to CSRF attacks",
        "effort": "MEDIUM"
      },
      {
        "category": "SECURITY",
        "recommendation": "Implement proper OAuth state parameter validation",
        "impact": "Vulnerability to CSRF attacks",
        "effort": "MEDIUM"
      }
    ],
    "systemReadiness": "READY"
  }
}